<!--  ViewItemFormOnTab


Change History
---------------

Peter Schroer   06-22-2006  Original baseline for Karsten's demo
=====================================================================================================
-->
<html>
<head>
<link rel="stylesheet" href="../../styles/default.css">
<style type="text/css">
  .loadingAppletStyle{ width:0px;  height:0px;  visibility:hidden;  }
  .loadedGridStyle   { width:expression(document.body.clientWidth); height:expression(document.body.clientHeight-30); visibility:visible; }
</style>
<script type="text/javascript">document.writeln('<base HREF="'+top.aras.getScriptsURL()+'" />');</script>
<script language="JavaScript"  src="../javascript/scriptset2.aspx"></script>
<script type="text/javascript" src="../javascript/AddConfigurationLink.js">Toolbar;TreeTable</script>
<script>
//global variables

var myInnovator = new top.Innovator();
var theItem  = null;
var theItemId = "";

//  here are the configuration properties
var theItemPropertyName= "brief";
var theItemType="brief";


function onTabSelected() {
	initForm();
}

function initForm() {
	var theItemId = parent.thisItem.getProperty(theItemPropertyName,"");
	if (theItemId=="" || theItemId== null) {
		// we have the option of creating an empty one now and displaying it in the grid.

		if (parent.thisItem.isLocked() != 1 && !parent.thisItem.isNew() && parent.thisItem.getAttribute("action")!="add") {
			// Parent thing does not appear to be ready for any editing.  so can't add now
			document.content_area.document.write(parent.thisItem.getProperty("keyed_name","") + " must be locked to create this content");
			return;
		}
 		theItemId = myInnovator.getNewID();
		parent.thisItem.setProperty(theItemPropertyName,theItemId);
		theItem = myInnovator.newItem(theItemType,"add");
		theItem.setID(theItemId);
		parent.thisItem.setPropertyItem(theItemPropertyName,theItem);

		if (parent.thisItem.getAttribute("action")!="add") parent.thisItem.setAttribute("action","update");
		parent.thisItem.setAttribute("isDirty","1");
	} else {
		theItem = parent.thisItem.getPropertyItem(theItemPropertyName);

		if (!theItem || (parent.thisItem.isLocked() != 1 && !parent.thisItem.isNew()) ) { // have to fetch it from the DB
			theItem = myInnovator.newItem(theItemType,"get");
			theItem.setID(theItemId);

			theItem = theItem.apply();
			parent.thisItem.setPropertyItem(theItemPropertyName,theItem);
		}
	}


	if (parent.thisItem.isLocked() != 1 && !parent.thisItem.isNew() && parent.thisItem.getAttribute("action")!="add")
	   top.aras.uiShowItemInFrameEx(document.content_area,theItem.node,"view",0)
   else
	   top.aras.uiShowItemInFrameEx(document.content_area,theItem.node,"edit",0)
}

</script>
</head>
<body topmargin="0" leftmargin="0" bgcolor= "#d4d0c8" onLoad="initForm()">
<iframe width='100%' height='100%' name='content_area' id='content_area'></iframe>
</body>
</html>

